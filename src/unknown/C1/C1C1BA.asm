
UNKNOWN_C1C1BA: ;$C1C1BA
	REP #PROC_FLAGS::ACCUM8 | PROC_FLAGS::INDEX8 | PROC_FLAGS::CARRY
	RESERVE_STACK_SPACE 23
	STY $04
	PHA
	LDA $04
	STA $15
	PLA
	STX $02
	TAX
	CPX #$0003
	BNE @UNKNOWN0
	LDA #$0000
	JMP @UNKNOWN12
@UNKNOWN0:
	TXY
	DEY
	STY $13
	LDX #$0001
	STX $11
	JMP @UNKNOWN8
@UNKNOWN1:
	LDY $13
	TYA
	BEQ @UNKNOWN2
	CMP #$0001
	BEQ @UNKNOWN3
	CMP #$0003
	BEQ @UNKNOWN4
	BRA @UNKNOWN5
@UNKNOWN2:
	LDA $0E
	CLC
	ADC #$0006
	CLC
	ADC $06
	STA $06
	SEP #PROC_FLAGS::ACCUM8
	LDA [$06]
	STA $00
	STA $10
	BRA @UNKNOWN5
@UNKNOWN3:
	LDA $0E
	CLC
	ADC #$0007
	BRK
	CLC
	ADC $06
	STA $06
	SEP #PROC_FLAGS::ACCUM8
	LDA [$06]
	STA $00
	STA $10
	BRA @UNKNOWN5
@UNKNOWN4:
	LDA $0E
	CLC
	ADC #$0008
	BRK
	CLC
	ADC $06
	STA $06
	SEP #PROC_FLAGS::ACCUM8
	LDA [$06]
	STA $00
	STA $10
@UNKNOWN5:
	SEP #PROC_FLAGS::ACCUM8
	LDA $10
	STA $00
	REP #PROC_FLAGS::ACCUM8
	LDA $00
	AND #$00FF
	BEQ @UNKNOWN7
	LOADPTR PSI_ABILITY_TABLE, $06
	TXA
	STA $04
	ASL
	ADC $04
	ASL
	ADC $04
	ASL
	ADC $04
	STA $0E
	INC
	INC
	INC
	MOVE_INTX $06, $0A
	CLC
	ADC $0A
	STA $0A
	LDA [$0A]
	AND #$00FF
	AND $02
	BEQ @UNKNOWN7
	TYA
	LDY #.SIZEOF(char_struct)
	JSL MULT168
	TAX
	SEP #PROC_FLAGS::ACCUM8
	LDA $00
	CMP CHAR_STRUCT+char_struct::level,X
	BGT @UNKNOWN7
	REP #PROC_FLAGS::ACCUM8
	LDA $15
	STA $04
	LDA $0E
	INC
	INC
	CLC
	ADC $06
	STA $06
	LDA [$06]
	AND #$00FF
	AND $04
	BEQ @UNKNOWN7
	LDA #$0001
	JMP @UNKNOWN12
@UNKNOWN7:
	LDX $11
	INX
	STX $11
@UNKNOWN8:
	REP #PROC_FLAGS::ACCUM8
	LOADPTR PSI_ABILITY_TABLE, $06
	TXA
	STA $04
	ASL
	ADC $04
	ASL
	ADC $04
	ASL
	ADC $04
	STA $0E
	MOVE_INTY $06, $0A
	CLC
	ADC $0A
	STA $0A
	LDA [$0A]
	AND #$00FF
	BNEL @UNKNOWN1
	LDY $13
	BNE @UNKNOWN10
	LDA $02
	AND #$0001
	BEQ @UNKNOWN10
	LDA GAME_STATE+game_state::party_psi
	AND #$00FF
	AND #$0001
	BEQ @UNKNOWN10
	LDA $15
	STA $04
	AND #$0008
	BEQ @UNKNOWN10
	LDA #$0001
	BRA @UNKNOWN12
@UNKNOWN10:
	CPY #$0003
	BNE @UNKNOWN11
	LDA $02
	AND #$0002
	BEQ @UNKNOWN11
	LDA GAME_STATE+game_state::party_psi
	AND #$00FF
	AND #$0006
	BEQ @UNKNOWN11
	LDA $15
	STA $04
	AND #$0001
	BEQ @UNKNOWN11
	LDA #$0001
	BRA @UNKNOWN12
@UNKNOWN11:
	LDA #$0000
@UNKNOWN12:
	PLD
	RTS
