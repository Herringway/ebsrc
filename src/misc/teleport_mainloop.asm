
;void Teleport_MainLoop(void)
TELEPORT_MAINLOOP: ;$C0EA99
	REP #PROC_FLAGS::ACCUM8 | PROC_FLAGS::INDEX8 | PROC_FLAGS::CARRY
	RESERVE_STACK_SPACE_CLOBBER 22
	JSL STOP_MUSIC
	JSL WAIT_UNTIL_NEXT_FRAME
	JSR TELEPORT_FREEZEOBJECTS
	LDA #$0001
	STA .LOWORD(UNKNOWN_7E5DBA)
	LDA #$0000
	STA .LOWORD(UNKNOWN_7E9F45)
	LDA #$0000
	STA .LOWORD(UNKNOWN_7E9F47)
	STZ .LOWORD(UNKNOWN_7E9F43)
	JSL UNKNOWN_C07C5B
	JSR a:.LOWORD(UNKNOWN_C0DE46)
	LDA .LOWORD(TELEPORT_STYLE)
	CMP #TELEPORT_STYLE::PSI_ALPHA
	BEQ @STYLE_1_OR_5
	CMP #TELEPORT_STYLE::UNKNOWN
	BEQ @STYLE_1_OR_5
	CMP #TELEPORT_STYLE::PSI_BETA
	BEQ @STYLE_2
	CMP #TELEPORT_STYLE::INSTANT
	BEQ @STYLE_3
	CMP #TELEPORT_STYLE::PSI_BETTER
	BEQ @STYLE_4
	BRA @STYLE_OTHER
@STYLE_1_OR_5:
	LOADPTR UNKNOWN_C0E28F, $0E
	LOADPTR UNKNOWN_C0E3C1, $12
	LDA #$0017
	JSL SET_PARTY_TICK_CALLBACKS
	BRA @STYLE_OTHER
@STYLE_2:
	LOADPTR UNKNOWN_C0E516, $0E
	LOADPTR UNKNOWN_C0E3C1, $12
	LDA #$0017
	JSL SET_PARTY_TICK_CALLBACKS
	BRA @STYLE_OTHER
@STYLE_3:
	LDA #$0001
	STA .LOWORD(UNKNOWN_7E9F43)
	BRA @STYLE_OTHER
@STYLE_4:
	LOADPTR UNKNOWN_C0E516, $0E
	LOADPTR UNKNOWN_C0E3C1, $12
	LDA #$0017
	JSL SET_PARTY_TICK_CALLBACKS
@STYLE_OTHER:
	LDA .LOWORD(TELEPORT_STYLE)
	CMP #TELEPORT_STYLE::INSTANT
	BEQ @UNKNOWN6
	LDA #MUSIC::TELEPORT_OUT
	JSL CHANGE_MUSIC
	BRA @UNKNOWN6
@UNKNOWN5:
	JSL OAM_CLEAR
	JSL RUN_ACTIONSCRIPT_FRAME
	JSR a:.LOWORD(TELEPORT_FREEZEOBJECTS2)
	JSL UPDATE_SCREEN
	JSL WAIT_UNTIL_NEXT_FRAME
@UNKNOWN6:
	LDA .LOWORD(UNKNOWN_7E9F43)
	BEQ @UNKNOWN5
	LDA .LOWORD(UNKNOWN_7E9F43)
	CMP #$0001
	BEQ @UNKNOWN7
	CMP #$0002
	BEQ @UNKNOWN8
	BRA @UNKNOWN9
@UNKNOWN7:
	JSR a:.LOWORD(UNKNOWN_C0E815)
	JSL UNKNOWN_C0DD79
	JSR a:.LOWORD(UNKNOWN_C0E897)
	LDA .LOWORD(TELEPORT_STYLE)
	CMP #TELEPORT_STYLE::UNKNOWN
	BNE @UNKNOWN9
	LOADPTR TEXT_LEARNED_PSI_TELEPORT_ALPHA, $0E
	JSL UNKNOWN_C46881
	BRA @UNKNOWN9
@UNKNOWN8:
	JSR a:.LOWORD(UNKNOWN_C0E9BA)
	LDA #$000A
	JSL UNKNOWN_C0DD2C
@UNKNOWN9:
	LOADPTR UNKNOWN_C05200, $0E
	LOADPTR UNKNOWN_C04D78, $12
	LDA #$0017
	JSL SET_PARTY_TICK_CALLBACKS
	JSR a:.LOWORD(UNKNOWN_C0DE7C)
	JSL UNKNOWN_C09451
	STZ .LOWORD(UNKNOWN_7E5DBA)
	MOVE_INT_CONSTANT NULL, .LOWORD(UNKNOWN_7E9F45)
	STZ .LOWORD(UNKNOWN_7E5D58)
	STZ .LOWORD(TELEPORT_DESTINATION)
	PLD
	RTL