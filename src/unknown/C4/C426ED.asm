
UPDATE_MAP_PALETTE_ANIMATION:
	REP #PROC_FLAGS::ACCUM8
	PHD
	PHA
	TDC
	SEC
	SBC #$0002
	TCD
	PLA
	LDX #$0000
@UNKNOWN0:
	LDA BUFFER + $200,X
	CLC
	ADC BUFFER + $800,X
	STA BUFFER + $800,X
	BPL @UNKNOWN1
	LDA #$0000
	STA BUFFER + $200,X
	BRA @UNKNOWN2
@UNKNOWN1:
	AND #$1F00
	CMP #$1F00
	BNE @UNKNOWN2
	LDA #$0000
	STA BUFFER + $200,X
	LDA #$1F00
@UNKNOWN2:
	XBA
	STA $00
	LDA BUFFER + $400,X
	CLC
	ADC BUFFER + $A00,X
	STA BUFFER + $A00,X
	BPL @UNKNOWN3
	LDA #$0000
	STA BUFFER + $400,X
	BRA @UNKNOWN4
@UNKNOWN3:
	AND #$1F00
	CMP #$1F00
	BNE @UNKNOWN4
	LDA #$0000
	STA BUFFER + $400,X
	LDA #$1F00
@UNKNOWN4:
	LSR
	LSR
	LSR
	ORA $00
	STA $00
	LDA BUFFER + $600,X
	CLC
	ADC BUFFER + $C00,X
	STA BUFFER + $C00,X
	BPL @UNKNOWN5
	LDA #$0000
	STA BUFFER + $400,X
	BRA @UNKNOWN6
@UNKNOWN5:
	AND #$1F00
	CMP #$1F00
	BNE @UNKNOWN6
	LDA #$0000
	STA BUFFER + $600,X
	LDA #$1F00
@UNKNOWN6:
	ASL
	ASL
	ORA $00
	STA PALETTES,X
	INX
	INX
	CPX #$0200
	BNEL @UNKNOWN0
	SEP #PROC_FLAGS::ACCUM8
	LDA #PALETTE_UPLOAD::FULL
	STA PALETTE_UPLOAD_MODE
	REP #PROC_FLAGS::ACCUM8
	PLD
	RTL
