
OPEN_MENU_BUTTON: ;$C134A7
	REP #PROC_FLAGS::ACCUM8 | PROC_FLAGS::INDEX8 | PROC_FLAGS::CARRY
	RESERVE_STACK_SPACE_CLOBBER 37
	JSL UNKNOWN_C0943C
	LDA #SFX::CURSOR1
	JSL PLAY_SOUND
	CREATE_WINDOW_NEAR #WINDOW::UNKNOWN00
	SEP #PROC_FLAGS::ACCUM8
	STZ UNKNOWN_7E5E6C
	JSR UNKNOWN_C133B0
	SEP #PROC_FLAGS::ACCUM8
	STZ UNKNOWN_7E5E79
@MAIN_PAUSE_MENU:
	REP #PROC_FLAGS::ACCUM8
	LDA #$0000
	JSR SET_WINDOW_FOCUS
	LDA #$0001
	JSR SELECTION_MENU
	STORE_INT1632 $06
	LDA $06
	CMP #MENU_OPTIONS::TALK_TO
	BEQ @TALK_TO
	CMP #MENU_OPTIONS::GOODS
	BEQ @GOODS
	CMP #MENU_OPTIONS::PSI
	BEQL @PSI
	CMP #MENU_OPTIONS::EQUIP
	BEQL @EQUIP
	CMP #MENU_OPTIONS::CHECK
	BEQL @CHECK
	CMP #MENU_OPTIONS::STATUS
	BEQL @STATUS
	JMP @UNKNOWN75
@TALK_TO:
	JSL TALK_TO
	MOVE_INT_CONSTANT NULL, $0A
	CMP32 $06, $0A
	BNE @UNKNOWN7
	LOADPTR MSG_SYS_HANASU_NG, $06
@UNKNOWN7:
	MOVE_INT $06, $0E
	JSL DISPLAY_TEXT
	JMP @UNKNOWN75
@GOODS:
	JSR UNKNOWN_C1134B
@UNKNOWN9:
	LDA GAME_STATE+game_state::player_controlled_party_count
	AND #$00FF
	CMP #$0001
	BNE @GOODS_MANY_PARTY_MEMBERS
	LDY #.LOWORD(GAME_STATE) + game_state::party_members
	STY $23
	LDX #$0001
	LDA RAM,Y
	AND #$00FF
	JSL GET_CHARACTER_ITEM
	CMP #$0000
	BEQL @MAIN_PAUSE_MENU
	LDX #$0002
	LDY $23
	LDA RAM,Y
	AND #$00FF
	JSR INVENTORY_GET_ITEM_NAME
	LDY $23
	SEP #PROC_FLAGS::ACCUM8
	LDA RAM,Y
	STORE_INT832 $06
	REP #PROC_FLAGS::ACCUM8
	MOVE_INT $06, $1F
	LDA #$0000
	JSL UNKNOWN_C43573
	BRA @UNKNOWN12
@GOODS_MANY_PARTY_MEMBERS:
	LDA #$0000
	JSR UNKNOWN_C193E7
	LOADPTR UNKNOWN_C1339E, $0E
	MOVE_INT_CONSTANT NULL, $12
	LDX #$0001
	LDA #$0000
	JSR CHAR_SELECT_PROMPT
	STORE_INT1632 $06
	MOVE_INT $06, $1F
@UNKNOWN12:
	MOVE_INT_CONSTANT NULL, $0A
	CMP32 $06, $0A
	BNE @UNKNOWN14
	LDA #$0002
	JSL CLOSE_WINDOW
	JSR UNKNOWN_C19437
	JMP @MAIN_PAUSE_MENU
@UNKNOWN14:
	LDX #$0001
	LDA $06
	JSL GET_CHARACTER_ITEM
	CMP #$0000
	BEQL @UNKNOWN9
@UNKNOWN15:
	LDA #$0001
	JSR UNKNOWN_C193E7
	LDA #$0002
	JSR SET_WINDOW_FOCUS
	LDA #$0001
	JSR SELECTION_MENU
	STA $04
	STA $1D
	JSL UNKNOWN_EF016F
	JSR UNKNOWN_C19437
	LDA $04
	BNE @GOODS_ITEM_SELECTED
	LDA GAME_STATE+game_state::player_controlled_party_count
	AND #$00FF
	CMP #$0001
	BNEL @UNKNOWN9
	LDX #$0001
	LDA GAME_STATE + game_state::party_members
	AND #$00FF
	JSL GET_CHARACTER_ITEM
	CMP #$0000
	BEQ @UNKNOWN17
	LDA #SFX::MENU_OPEN_CLOSE
	JSL PLAY_SOUND
	JSL UNKNOWN_C3E6F8
@UNKNOWN17:
	LDA #$0002
	JSL CLOSE_WINDOW
	JMP @MAIN_PAUSE_MENU
@GOODS_ITEM_SELECTED:
	CREATE_WINDOW_NEAR #WINDOW::INVENTORY_MENU
	MOVE_INT $1F, $06
	LDA $06
	DEC
	LDY #.SIZEOF(char_struct)
	JSL MULT168
	TAX
	LDA CHAR_STRUCT+char_struct::afflictions,X
	AND #$00FF
	TAX
	BEQ @GOODS_ITEM_SELECTED_ALIVE
	STX $02
	LDA #$0004
	CLC
	SBC $02
	BRANCHLTEQS @GOODS_ITEM_SELECTED_ALIVE
	LDX #$0001
	BRA @UNKNOWN22
@GOODS_ITEM_SELECTED_ALIVE:
	LDX #$0000
@UNKNOWN22:
	TXY
	STY $23
	TYX
	LDA #$0000
	JSL UNKNOWN_C438A5
	BRA @UNKNOWN24
@UNKNOWN23:
	TYX
	INX
	STX $1B
	LOADPTR ITEM_USE_MENU_STRINGS, $06
	TYA
	OPTIMIZED_MULT $04, 6
	CLC
	ADC $06
	STA $06
	STA $0E
	LDA $08
	STA $10
	MOVE_INT_CONSTANT NULL, $12
	TXA
	JSR UNKNOWN_C115F4
	LDX $1B
	TXY
	STY $23
@UNKNOWN24:
	LDY $23
	CPY #$0004
	BCC @UNKNOWN23
	LDY #$0000
	TYX
	LDA #$0001
	JSL UNKNOWN_C451FA
	LDA #$0000
	STA $02
@UNKNOWN25:
	REP #PROC_FLAGS::ACCUM8
	LDA $02
	BEQ @UNKNOWN26
	LDA #$0002
	JSR SET_WINDOW_FOCUS
	SEP #PROC_FLAGS::ACCUM8
	LDA $1A
	STA $00
	REP #PROC_FLAGS::ACCUM8
	LDA $00
	AND #$00FF
	BEQ @UNKNOWN27
	JSR PRINT_MENU_ITEMS
	BRA @UNKNOWN27
@UNKNOWN26:
	LDA #$0003
	JSR SET_WINDOW_FOCUS
	JSR PRINT_MENU_ITEMS
@UNKNOWN27:
	LDA #$0003
	JSR SET_WINDOW_FOCUS
	LDA #$0001
	JSR SELECTION_MENU
	STORE_INT1632 $0A
	LDA $0A
	BEQ @UNKNOWN30
	CMP #$0001
	BEQ @GOODS_ITEM_USE
	CMP #$0004
	BEQ @GOODS_ITEM_HELP
	CMP #$0002
	BEQL @UNKNOWN34
	CMP #$0003
	BEQL @UNKNOWN63
	JMP @UNKNOWN75
@UNKNOWN30:
	JSR CLOSE_FOCUS_WINDOW
	LDA #$0002
	JSR SET_WINDOW_FOCUS
	JMP @UNKNOWN15
@GOODS_ITEM_USE:
	LDA #$0001
	STA $02
	LDY #$0000
	LDA $1D
	STA $04
	LDX $04
	MOVE_INT $1F, $06
	LDA $06
	JSR OVERWORLD_USE_ITEM
	CMP #$0000
	BNEL @UNKNOWN75
	SEP #PROC_FLAGS::ACCUM8
	LDA #$0000
	STA $00
	STA $1A
	JMP @UNKNOWN25
@GOODS_ITEM_HELP:
	LDA #$0000
	BRK
	JSR UNKNOWN_C10F40
	LDA #$0002
	BRK
	JSR UNKNOWN_C10F40
	SEP #PROC_FLAGS::ACCUM8
	LDA #$00FF
	STA UNKNOWN_7E5E79
	REP #PROC_FLAGS::ACCUM8
	CREATE_WINDOW_NEAR #WINDOW::TEXT_STANDARD
	MOVE_INT $1F, $06
	LDA $06
	TAY
	STY $23
	LDA $1D
	STA $04
	LDX $04
	TYA
	JSL GET_CHARACTER_ITEM
	STA $1D
	LOADPTR ITEM_CONFIGURATION_TABLE, $0A
	LDA $1D
	LDY #.SIZEOF(item)
	JSL MULT168
	CLC
	ADC #item::help_text
	CLC
	ADC $0A
	STA $0A
	DEREFERENCE_PTR_TO $0A, $06
	MOVE_INT $06, $0E
	JSL DISPLAY_TEXT
	LDA #$0001
	JSL CLOSE_WINDOW
	LDA #$0000
	JSR SET_WINDOW_FOCUS
	SEP #PROC_FLAGS::ACCUM8
	LDA #$0001
	STA UNKNOWN_7E5E6C
	JSR UNKNOWN_C133B0
	.A16
	LDX #$0002
	LDY $23
	TYA
	JSR INVENTORY_GET_ITEM_NAME
	LDA #$0003
	JSL CLOSE_WINDOW
	LDA #$0002
	JSR SET_WINDOW_FOCUS
	JMP @UNKNOWN15
@UNKNOWN34:
	LDA #$0002
	JSR SET_WINDOW_FOCUS
	JSR UNKNOWN_C10FA3
	LDA #$0001
	STA $02
	LDA #$0003
	JSR UNKNOWN_C193E7
	LOADPTR UNKNOWN_C133A7, $0E
	MOVE_INT_CONSTANT NULL, $12
	LDX #$0001
	LDA #$0002
	JSR CHAR_SELECT_PROMPT
	STA $18
	JSR UNKNOWN_C19437
	LDA #$002C
	JSL CLOSE_WINDOW
	LDA $18
	BNE @UNKNOWN35
	SEP #PROC_FLAGS::ACCUM8
	LDA #$0001
	STA $00
	STA $1A
	JMP @UNKNOWN25
@UNKNOWN35:
	MOVE_INT $1F, $06
	MOVE_INT1632 $18, $0A
	CMP32 $0A, $06
	BEQ @UNKNOWN37
	LDA $1D
	STA $04
	LDX $04
	LDA $06
	JSL GET_CHARACTER_ITEM
	LDY #.SIZEOF(item)
	JSL MULT168
	.A16
	CLC
	ADC #item::flags
	TAX
	LDA f:ITEM_CONFIGURATION_TABLE,X
	AND #$00FF
	AND #ITEM_FLAGS::CANNOT_GIVE
	BEQ @UNKNOWN37
	CREATE_WINDOW_NEAR #WINDOW::TEXT_STANDARD
	MOVE_INT $06, $0E
	JSR SET_WORKING_MEMORY
	MOVE_INT1632 $04, $06
	MOVE_INT $06, $0E
	JSR SET_ARGUMENT_MEMORY
	DISPLAY_TEXT_PTR MSG_SYS_GOODS_NOCARRY
	LDA #$0001
	JSL CLOSE_WINDOW
	SEP #PROC_FLAGS::ACCUM8
	LDA #$0001
	STA $00
	STA $1A
	JMP @UNKNOWN25
@UNKNOWN37:
	LDX #$0000
	STX $16
	LDA $06
	DEC
	LDY #.SIZEOF(char_struct)
	JSL MULT168
	.A16
	TAX
	LDA CHAR_STRUCT+char_struct::afflictions,X
	AND #$00FF
	TAY
	CPY #$0001
	BEQ @UNKNOWN38
	CPY #$0002
	BNE @UNKNOWN39
@UNKNOWN38:
	LDX #$0005
	STX $16
@UNKNOWN39:
	MOVE_INT1632 $18, $0A
	CMP32 $0A, $06
	.A16
	BEQ @UNKNOWN43
	LDX $16
	INX
	STX $16
	LDA $18
	JSL FIND_INVENTORY_SPACE2
	CMP #$0000
	BEQ @UNKNOWN41
	LDX $16
	INX
	INX
	STX $16
@UNKNOWN41:
	LDA $18
	DEC
	LDY #.SIZEOF(char_struct)
	JSL MULT168
	TAX
	LDA CHAR_STRUCT+char_struct::afflictions,X
	AND #$00FF
	TAY
	CPY #$0001
	BEQ @UNKNOWN42
	CPY #$0002
	BNE @UNKNOWN43
@UNKNOWN42:
	LDX $16
	INX
	STX $16
@UNKNOWN43:
	CREATE_WINDOW_NEAR #WINDOW::TEXT_STANDARD
	JSR GET_ACTIVE_WINDOW_ADDRESS
	STA $23
	CLC
	ADC #$0017
	TAY
	MOVE_INT_YPTRDEST $06, RAM
	MOVE_INT1632 $18, $0A
	LDA $23
	CLC
	ADC #$0021
	TAY
	MOVE_INT_YPTRDEST $0A, RAM
	LDA $1D
	STA $04
	STORE_INT1632 $0A
	LDA $23
	CLC
	ADC #$001B
	TAY
	MOVE_INT_YPTRDEST $0A, RAM
	LDX $16
	TXA
	BEQ @GOODS_GIVE_SELF_ALIVE_TEXT
	CMP #$0001
	BEQ @GOODS_GIVE_ALIVE_TO_ALIVE_FAIL_TEXT
	CMP #$0002
	BEQ @GOODS_GIVE_ALIVE_TO_DEAD_FAIL_TEXT
	CMP #$0003
	BEQL @GOODS_GIVE_ALIVE_TO_ALIVE_SUCC_TEXT
	CMP #$0004
	BEQL @GOODS_GIVE_ALIVE_TO_DEAD_SUCC_TEXT
	CMP #$0005
	BEQL @GOODS_GIVE_SELF_DEAD_TEXT
	CMP #$0006
	BEQL @GOODS_GIVE_DEAD_TO_ALIVE_FAIL_TEXT
	CMP #$0007
	BEQL @GOODS_GIVE_DEAD_TO_DEAD_FAIL_TEXT
	CMP #$0008
	BEQL @GOODS_GIVE_DEAD_TO_ALIVE_SUCC_TEXT
	CMP #$0009
	BEQL @GOODS_GIVE_DEAD_TO_DEAD_SUCC_TEXT
	JMP @GOODS_GIVE_INVALID_TEXT
@GOODS_GIVE_SELF_ALIVE_TEXT:
	DISPLAY_TEXT_PTR MSG_SYS_CARRY_SELF_ALIVE
	LDY $04
	MOVE_INT $1F, $06
	LDA $06
	TAX
	LDA $18
	JSL UNKNOWN_C22A3A
	JMP @UNKNOWN62
@GOODS_GIVE_ALIVE_TO_ALIVE_FAIL_TEXT:
	DISPLAY_TEXT_PTR MSG_SYS_CARRY_FAIL_OTHER_ALIVE_ALIVE
	JMP @UNKNOWN62
@GOODS_GIVE_ALIVE_TO_DEAD_FAIL_TEXT:
	DISPLAY_TEXT_PTR MSG_SYS_CARRY_FAIL_OTHER_ALIVE_DEAD
	JMP @UNKNOWN62
@GOODS_GIVE_ALIVE_TO_ALIVE_SUCC_TEXT:
	DISPLAY_TEXT_PTR MSG_SYS_CARRY_OTHER_ALIVE_ALIVE
	LDY $04
	MOVE_INT $1F, $06
	LDA $06
	TAX
	LDA $18
	JSL UNKNOWN_C22A3A
	JMP @UNKNOWN62
@GOODS_GIVE_ALIVE_TO_DEAD_SUCC_TEXT:
	DISPLAY_TEXT_PTR MSG_SYS_CARRY_OTHER_ALIVE_DEAD
	LDY $04
	MOVE_INT $1F, $06
	LDA $06
	TAX
	LDA $18
	JSL UNKNOWN_C22A3A
	JMP @UNKNOWN62
@GOODS_GIVE_SELF_DEAD_TEXT:
	DISPLAY_TEXT_PTR MSG_SYS_CARRY_SELF_DEAD
	LDY $04
	MOVE_INT $1F, $06
	LDA $06
	TAX
	LDA $18
	JSL UNKNOWN_C22A3A
	BRA @UNKNOWN62
@GOODS_GIVE_DEAD_TO_ALIVE_FAIL_TEXT:
	DISPLAY_TEXT_PTR MSG_SYS_CARRY_FAIL_OTHER_DEAD_ALIVE
	BRA @UNKNOWN62
@GOODS_GIVE_DEAD_TO_DEAD_FAIL_TEXT:
	DISPLAY_TEXT_PTR MSG_SYS_CARRY_FAIL_OTHER_DEAD_DEAD
	BRA @UNKNOWN62
@GOODS_GIVE_DEAD_TO_ALIVE_SUCC_TEXT:
	DISPLAY_TEXT_PTR MSG_SYS_CARRY_OTHER_DEAD_ALIVE
	LDY $04
	MOVE_INT $1F, $06
	LDA $06
	TAX
	LDA $18
	JSL UNKNOWN_C22A3A
	BRA @UNKNOWN62
@GOODS_GIVE_DEAD_TO_DEAD_SUCC_TEXT:
	DISPLAY_TEXT_PTR MSG_SYS_CARRY_OTHER_DEAD_DEAD
	LDY $04
	MOVE_INT $1F, $06
	LDA $06
	TAX
	LDA $18
	JSL UNKNOWN_C22A3A
	BRA @UNKNOWN62
@GOODS_GIVE_INVALID_TEXT:
	BRA @GOODS_GIVE_INVALID_TEXT
@UNKNOWN62:
	LDA #$0001
	JSL CLOSE_WINDOW
	LDA #$0003
	JSL CLOSE_WINDOW
	LDA #$0002
	JSL CLOSE_WINDOW
	JMP @MAIN_PAUSE_MENU
@UNKNOWN63:
	CREATE_WINDOW_NEAR #WINDOW::TEXT_STANDARD
	MOVE_INT $1F, $06
	MOVE_INT $06, $0E
	JSR SET_WORKING_MEMORY
	LDA $1D
	STA $04
	STORE_INT1632 $06
	MOVE_INT $06, $0E
	JSR SET_ARGUMENT_MEMORY
	DISPLAY_TEXT_PTR MSG_SYS_GOODS_DROP
	LDA #$0001
	JSL CLOSE_WINDOW
	LDA #$0003
	JSL CLOSE_WINDOW
	LDA #$0002
	JSL CLOSE_WINDOW
	JMP @MAIN_PAUSE_MENU
@PSI:
	JSR UNKNOWN_C1134B
	JSR UNKNOWN_C1C373
	STORE_INT1632 $06
	MOVE_INT_CONSTANT NULL, $0A
	CMP32 $06, $0A
	BEQ @UNKNOWN66
	LDA $06
	DEC
	JSL UNKNOWN_C43573
@UNKNOWN66:
	JSR UNKNOWN_C1B5B6
	CMP #$0000
	BNEL @UNKNOWN75
	JSR UNKNOWN_C1C3B6
	CMP #$0001
	BNEL @MAIN_PAUSE_MENU
	LDA #SFX::MENU_OPEN_CLOSE
	JSL PLAY_SOUND
	JSL UNKNOWN_C3E6F8
	JMP @MAIN_PAUSE_MENU
@EQUIP:
	JSR UNKNOWN_C1134B
	JSR UNKNOWN_C1AA5D
	LDA GAME_STATE+game_state::player_controlled_party_count
	AND #$00FF
	CMP #$0001
	BNEL @MAIN_PAUSE_MENU
	LDA #SFX::MENU_OPEN_CLOSE
	JSL PLAY_SOUND
	JSL UNKNOWN_C3E6F8
	JMP @MAIN_PAUSE_MENU
@CHECK:
	JSL CHECK
	MOVE_INT_CONSTANT NULL, $0A
	CMP32 $06, $0A
	BNE @UNKNOWN73
	LOADPTR MSG_SYS_NOPROBLEM, $06
@UNKNOWN73:
	MOVE_INT $06, $0E
	JSL DISPLAY_TEXT
	BRA @UNKNOWN75
@STATUS:
	JSR UNKNOWN_C1134B
	SEP #PROC_FLAGS::ACCUM8
	LDA #$0001
	STA UNKNOWN_7E5E71
	JSR UNKNOWN_C1BB71
	SEP #PROC_FLAGS::ACCUM8
	STZ UNKNOWN_7E5E71
	JMP @MAIN_PAUSE_MENU
@UNKNOWN75:
	JSL CLEAR_INSTANT_PRINTING
	JSR HIDE_HPPP_WINDOWS
	JSR UNKNOWN_C1008E
@UNKNOWN76:
	JSL WINDOW_TICK
	.A16
	LDA UNKNOWN_7EB4A8
	CMP #$FFFF
	BNE @UNKNOWN76
	JSL UNKNOWN_C09451
	PLD
	RTL
OPEN_MENU_BUTTON_CHECKTALK:
	REP #PROC_FLAGS::ACCUM8 | PROC_FLAGS::INDEX8 | PROC_FLAGS::CARRY
	RESERVE_STACK_SPACE_CLOBBER 18
	JSL UNKNOWN_C0943C
	LDA #SFX::CURSOR1
	JSL PLAY_SOUND
	JSL TALK_TO
	MOVE_INT_CONSTANT NULL, $0A
	CMP32 $06, $0A
	BNE @UNKNOWN79
	JSL CHECK
	CMP32 $06, $0A
	BNE @UNKNOWN79
	LOADPTR MSG_SYS_NOPROBLEM, $06
@UNKNOWN79:
	MOVE_INT $06, $0E
	JSL DISPLAY_TEXT
	JSL CLEAR_INSTANT_PRINTING
	JSR HIDE_HPPP_WINDOWS
	JSR UNKNOWN_C1008E
@UNKNOWN80:
	JSL WINDOW_TICK
	LDA UNKNOWN_7EB4A8
	CMP #$FFFF
	BNE @UNKNOWN80
	JSL UNKNOWN_C09451
	PLD
	RTL
